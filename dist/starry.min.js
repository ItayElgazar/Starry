"use strict";var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var Starry=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),i?!!this.setConfig(e)&&(this.domElement=i,void this.build()):(console.error("Starry: Missing DOM element!"),!1)}return _createClass(t,[{key:"setConfig",value:function(t){return this.config=t,void 0===this.config.stars&&(this.config.stars=5),void 0===this.config.multiRating&&(this.config.multiRating=!1),void 0===this.config.beginWith&&(this.config.beginWith=0),void 0===this.config.readOnly&&(this.config.readOnly=!1),void 0===this.config.staticActiveRating&&(this.config.staticActiveRating=!0),void 0===this.config.setStarsAfterRating&&(this.config.setStarsAfterRating=!0),void 0!==this.config.tooltips&&Array.isArray(this.config.tooltips)||(this.config.tooltips=!1),void 0===this.config.onRate&&(this.config.onRate=function(t){}),this.config.beginWith<0&&(this.config.beginWith=0),this.config.beginWith>100&&(this.config.beginWith=100),this.currentRating=this.config.beginWith/100*this.config.stars,void 0===this.config.name?(console.error("Starry: Give your Starry star rating elements a name!"),!1):void 0!==this.config.icons&&void 0!==this.config.icons.blank&&void 0!==this.config.icons.hover&&void 0!==this.config.icons.active||(console.error("Starry: No star icons defined yet!"),!1)}},{key:"checkCookie",value:function(){var t=document.cookie;t=t.split(";");var i=!0,e=!1,n=void 0;try{for(var r,a=t[Symbol.iterator]();!(i=(r=a.next()).done);i=!0){r.value.trim()==="Starry_"+this.config.name+"=true"&&(this.config.readOnly=!0)}}catch(t){e=!0,n=t}finally{try{!i&&a.return&&a.return()}finally{if(e)throw n}}}},{key:"setCookie",value:function(){var t=new Date;t.setTime(t.getTime()+31104e7),document.cookie="Starry_"+this.config.name+"=true; expires="+t.toGMTString()+"; sameSite=Lax",this.config.multiRating=!1,this.config.readOnly=!0}},{key:"build",value:function(){this.clear(),!1===this.config.multiRating&&this.checkCookie();var t=document.createElement("div");t.classList.add("Starry"),t.setAttribute("data-name",this.config.name);var i=document.createElement("div");i.classList.add("Starry-blank");var e=!0,n=!1,r=void 0;try{for(var a,o=this.getStarRow("blank")[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var s=a.value;i.appendChild(s)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}var c=document.createElement("div");c.classList.add("Starry-active"),!0!==this.config.staticActiveRating&&!0!==this.config.readOnly||c.classList.add("Starry-static"),c.style.width=this.config.beginWith+"%";var l=!0,f=!1,h=void 0;try{for(var g,d=this.getStarRow("active")[Symbol.iterator]();!(l=(g=d.next()).done);l=!0){s=g.value;c.appendChild(s)}}catch(t){f=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(f)throw h}}if(!1===this.config.readOnly){var u=document.createElement("div");u.classList.add("Starry-hover");var v=!0,y=!1,m=void 0;try{for(var p,b=this.getStarRow("hover")[Symbol.iterator]();!(v=(p=b.next()).done);v=!0){s=p.value;u.appendChild(s)}}catch(t){y=!0,m=t}finally{try{!v&&b.return&&b.return()}finally{if(y)throw m}}}t.appendChild(i),t.appendChild(c),!1===this.config.readOnly&&t.appendChild(u),this.domElement.appendChild(t),void 0!==this.config.onRender&&"function"==typeof this.config.onRender&&this.config.onRender()}},{key:"getStarRow",value:function(t){for(var i=this,e=[],n=this.config.stars;n>0;n--){var r=document.createElement("div");r.classList.add("Starry-star"),"hover"===t&&(r.setAttribute("data-value",n),Array.isArray(this.config.tooltips)&&(r.setAttribute("title",this.config.tooltips[n-1]),r.setAttribute("data-tooltip",this.config.tooltips[n-1])),r.addEventListener("click",function(t){var e=t.target;e.classList.contains("Starry-star")||(e=t.target.closest(".Starry-star")),!1!==i.config.onRate({name:i.config.name,value:e.getAttribute("data-value")})&&(i.currentRating=e.getAttribute("data-value"),!0===i.config.setStarsAfterRating&&(i.config.beginWith=parseInt(e.getAttribute("data-value"))/i.config.stars*100)),!1===i.config.multiRating&&i.setCookie(),i.build()}));var a=document.createElement("img");a.setAttribute("src",this.config.icons[t]),r.appendChild(a),e.push(r)}return e}},{key:"clear",value:function(){void 0!==this.config.onClear&&"function"==typeof this.config.onClear&&this.config.onClear(),this.domElement.innerHTML=""}},{key:"update",value:function(t){this.setConfig(t),this.build()}},{key:"getCurrentRating",value:function(){return this.currentRating}}]),t}();